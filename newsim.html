<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mobi-Comm Home</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="node_modules/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"/>
    <style>
        /* Professional Design Styles */
        .form-section {
            border: 1px solid #ddd;
            border-radius: 8px;
            margin-bottom: 20px;
            background-color: #f9f9f9;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            padding: 20px;
        }

        .form-section h5 {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: #333;
        }

        .personal-details-section {
            background-color: #ffffff;
        }

        .delivery-details-section {
            background-color: #fff8e1;
        }

        .form-label {
            font-weight: 600;
            color: #444;
        }

        .section-divider {
            border-bottom: 2px solid #ffc600;
            margin: 20px 0;
        }

        .btn-next {
            background-color: #ffc600;
            color: #fff;
            font-weight: 600;
            padding: 12px 20px;
            border-radius: 5px;
        }

        .btn-next:hover {
            background-color: #e6b800;
        }


    li {
        font-size: 1rem;
        color: #333;
    }

    li:hover {
        color: #007bff; /* Change text color on hover */
        cursor: pointer; /* Make cursor a pointer on hover */
    }

    </style>
</head>
<body>

<!-- HEADER STARTS -->
<header class="sticky-top shadow-sm bg-white">
    <div class="container py-3">
        <div class="d-flex justify-content-between align-items-center">
            <nav class="d-none d-md-flex gap-4">
                <a href="index.html" class="text-dark text-decoration-none nav-link">Home</a>
                <a href="recharge.html" class="text-dark text-decoration-none nav-link">Recharge</a>
                <a href="prepaidplans.html" class="text-dark text-decoration-none nav-link">Prepaid Plans</a>
            </nav>

            <div class="text-center">
                <img src="assets/img/Logo.png" alt="Company Logo" class="img-fluid" style="max-height: 45px;">
            </div>

            <nav class="d-none d-md-flex gap-4">
                <a href="about.html" class="text-dark text-decoration-none nav-link">About Us</a>
                <a href="contact.html" class="text-dark text-decoration-none nav-link">Contact Us</a>
                <a href="account.html" class="text-dark text-decoration-none nav-link">Account</a>
            </nav>
        </div>
    </div>
</header>

<!-- Combined Form with Differentiation Between Personal & Delivery Details -->
<section class="container my-4 p-4 shadow-lg rounded-4 bg-light text-dark">
    <h4 class="fw-bold text-center">Registration & Plan Selection</h4>

    <form>
        <!-- Personal Details Section -->
        <div class="form-section personal-details-section">
            <h5 class="section-title">Personal Details</h5>

            <div class="row">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label">Full Name</label>
                        <input type="text" class="form-control" id="fullName" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Date of Birth</label>
                        <input type="text" class="form-control" id="dob" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Email ID</label>
                        <input type="email" class="form-control" id="email" required>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label">Password</label>
                        <input type="password" class="form-control" id="password" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Aadhar Number</label>
                        <input type="text" class="form-control" id="idProof" required>
                    </div>
                </div>
            </div>
        </div>

        <div class="section-divider"></div>

        <!-- Delivery Details Section -->
        <div class="form-section delivery-details-section">
            <h5 class="section-title">Delivery Details</h5>

            <div class="row">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label">Address</label>
                        <textarea class="form-control" id="address" rows="3" required></textarea>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Pincode</label>
                        <input type="text" class="form-control" id="pincode" required>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label">City</label>
                        <input type="text" class="form-control" id="city" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">State</label>
                        <input type="text" class="form-control" id="state" required>
                    </div>
                </div>
            </div>
        </div>

        <div class="section-divider"></div>

        <!-- Mobile Number Selection -->
        <h5 class="fw-bold mt-4 text-center">Select Your Mobile Number</h5>
        <div class="container text-center mt-3">
            <div id="mobileNumbersContainer" class="row g-3"></div>
        </div>
    
        <!-- Pagination Buttons -->
        <div class="d-flex justify-content-between mt-3">
            <button type="button" class="btn btn-secondary fw-bold" id="prevBtn" disabled>Previous</button>
            <button type="button" class="btn btn-warning fw-bold" id="nextBtn">Next</button>
        </div>
    

        <div class="section-divider"></div>

        <!-- Payment Info -->

        <h5 class="fw-bold mt-4 text-center">Payment</h5>

        <div class="d-flex justify-content-center">
            <ol class="list-unstyled" style="width: 80%;"> <!-- Centering the ordered list -->
                <li class="d-flex align-items-center mb-3">
                    <span class="number-icon me-3">1</span>
                    After completing the registration, you will be redirected to the Mobi-Comm Plan page.
                </li>
                <li class="d-flex align-items-center mb-3">
                    <span class="number-icon me-3">2</span>
                    On the Mobi-Comm Plan page, you can browse and select the plan that best suits your needs.
                </li>
                <li class="d-flex align-items-center mb-3">
                    <span class="number-icon me-3">3</span>
                    Once you've selected your desired plan, proceed to make the payment for that plan.
                </li>
                <li class="d-flex align-items-center mb-3">
                    <span class="number-icon me-3">4</span>
                    You will receive your mobile number within 2 days of payment.
                </li>
                <li class="d-flex align-items-center mb-3">
                    <span class="number-icon me-3">5</span>
                    After receiving your number, call it to activate your SIM card.
                </li>
            </ol>
        </div>

        
        <button type="submit" class="btn btn-success w-100 btn-next" id="payButton" onclick="handlePayment()">Proceed to Pay</button>

        <div class="toast-container position-fixed top-0 end-0 p-3" style="z-index: 1050;">
            <div id="successToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
                <div class="toast-header">
                    <strong class="me-auto">Success</strong>
                    <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
                </div>
                <div class="toast-body">
                    Registered successfully!
                </div>
            </div>
        </div>
    </form>
</section>

<script>
document.addEventListener("DOMContentLoaded", function () {
    let mobileNumbersContainer = document.getElementById("mobileNumbersContainer");
    let prevBtn = document.getElementById("prevBtn");
    let nextBtn = document.getElementById("nextBtn");

    let currentSet = 0;
    const totalSets = 24;
    const numbersPerSet = 6;
    let mobileNumbers = [];
    let selectedMobileNumber = "";

    // Generate Random Mobile Number
    function generateMobileNumber() {
        const firstDigitOptions = [6, 7, 8, 9];
        let firstDigit = firstDigitOptions[Math.floor(Math.random() * firstDigitOptions.length)];
        let remainingDigits = Math.floor(100000000 + Math.random() * 900000000);
        return firstDigit + remainingDigits.toString();
    }

    // Generate All Mobile Numbers
    function generateAllNumbers() {
        mobileNumbers = [];
        for (let i = 0; i < totalSets * numbersPerSet; i++) {
            mobileNumbers.push(generateMobileNumber());
        }
    }

    // Display Mobile Numbers as Buttons
    function displayNumbers() {
        mobileNumbersContainer.innerHTML = "";
        let start = currentSet * numbersPerSet;
        let end = start + numbersPerSet;

        for (let i = start; i < end; i++) {
            let mobileNumber = mobileNumbers[i];

            let radioWrapper = document.createElement("div");
            radioWrapper.classList.add("col-12", "col-md-4", "d-flex", "justify-content-center");

            // Create radio button input element
            let radioElement = document.createElement("input");
            radioElement.type = "radio";
            radioElement.name = "mobileNumberSelection";
            radioElement.value = mobileNumber;
            radioElement.id = `mobileNumber${i}`;
            radioElement.classList.add("btn-check");
            radioElement.setAttribute("autocomplete", "off");

            // Create a label for the radio button
            let label = document.createElement("label");
            label.setAttribute("for", radioElement.id);
            label.classList.add("btn", "btn-outline-warning", "text-black", "rounded", "p-3", "text-center", "w-100", "fw-bold");
            label.innerHTML = `<span>${mobileNumber}</span>`;

            // Append radio button and label to the wrapper
            radioWrapper.appendChild(radioElement);
            radioWrapper.appendChild(label);

            // Append the number container to the main container
            mobileNumbersContainer.appendChild(radioWrapper);

            radioElement.addEventListener("click", function () {
                // Store the selected mobile number
                selectedMobileNumber = mobileNumber;
                console.log(`You selected: ${selectedMobileNumber}`);
            });
        }

        prevBtn.disabled = currentSet === 0;
        nextBtn.disabled = currentSet === totalSets - 1;
    }

    // Handle pagination for mobile numbers
    prevBtn.addEventListener("click", function () {
        if (currentSet > 0) {
            currentSet--;
            displayNumbers();
        }
    });

    nextBtn.addEventListener("click", function () {
        if (currentSet < totalSets - 1) {
            currentSet++;
            displayNumbers();
        }
    });

    // Generate and display mobile numbers on page load
    generateAllNumbers();
    displayNumbers();

    // Handle the form submission
    const form = document.querySelector("form");

    form.addEventListener("submit", function (event) {
        event.preventDefault(); // Prevent form from submitting the default way

        // Collect all form field values
        const fullName = document.getElementById("fullName").value;
        const dob = document.getElementById("dob").value;
        const email = document.getElementById("email").value;
        const password = document.getElementById("password").value;
        const idProof = document.getElementById("idProof").value;
        const address = document.getElementById("address").value;
        const pincode = document.getElementById("pincode").value;
        const city = document.getElementById("city").value;
        const state = document.getElementById("state").value;

        // Validate if a mobile number is selected
        if (!selectedMobileNumber) {
            alert("Please select a mobile number.");
            return;
        }

        // Create the user object to send to the backend
        const user = {
            name: fullName,
            dob: dob,
            emailId: email,
            password: password,
            aadhar: idProof,
            address: address,
            pincode: pincode,
            city: city,
            state: state,
            mobileNo: selectedMobileNumber // Include selected mobile number
        };

        // Send data to the backend using Fetch API
        fetch("http://localhost:9090/api/users/register", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify(user)
        })
        .then(response => {
            if (response.ok) {
                alert("Registration successful!");
                // Optionally, redirect to another page after success
                window.location.href = "prepaidplans.html"; // Redirect to the plans page
            } else {
                alert("Error registering user");
            }
        })
        .catch(error => {
            console.error("Error:", error);
            alert("An error occurred while registering.");
        });
    });
});


</script>

<script src="node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="node_modules/@popperjs/core/dist/umd/popper.min.js"></script>

</body>
</html>
